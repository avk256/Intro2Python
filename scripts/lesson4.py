# -*- coding: utf-8 -*-
"""Lesson4.ipynb

Automatically generated by Colab.

Original file is located at
    https://colab.research.google.com/drive/1UQ6S0HHKjNNWAfXRRGpgHfJIKStNclYo

# Функції в Python

## Створення та виклик функцій
"""

(3 + 4) * 2

"""int, float, str, bool"""

a_val = 2
b_val = 3.2
c_val = 'stroka'
d_val = True # False


print(type(a_val))
print(type(b_val))
print(type(c_val))
print(type(d_val))

print(a_val + b_val)

isinstance(a_val, (int, float, str))

isinstance(b_val, (int, float))

a_val = 2
b_val = 3.2
c_val = 'stroka'
d_val = True # False

def my_function(first_value, second_value):

    print(isinstance(first_value, (int, float)))
    print(isinstance(second_value, (int, float)))

    if isinstance(first_value, (int, float)) and isinstance(second_value, (int, float)):
        print(first_value + second_value)
    else:
        print('У вас невірні типи змінних')

my_function(a_val, b_val)

my_function(c_val, d_val)

5 + False



# коментар: a_value зберігає цілий тип
'''
тут великий коментар
на декілька рядків
'''

a_value = 5
b_value = 2
c_value = 1

print(a_value)
print(type(a_value))
print(b_value)
print(type(b_value))
print(type(c_value))

res = (a_value + b_value) * c_value

# print(res)
#

a = 3
b = 3.2
c = 's'

def add_values(a, b):
    return a + b


print(add_values(2, 3))

def filter_even(nums):
    out = []
    for n in nums:
        if n % 2 == 0:
            out.append(n)
    return out

print(filter_even([1, 2, 3, 4, 5, 6]))

# res = []
# print(res)
# print(type(res))
# res.append(2)
# print(res)

def take_until_stopwords(tokens, stop):
    res = []
    for word in tokens:
        print(word)
        if word in stop:
            break
        res.append(word)
    return res

print(take_until_stopwords(["read","parse","STOP","write"], {"STOP"}))

total = 0
for x in [1, 2, 3]:
    print(x)
    total += x
print('sum = ', total)

def sum_until_limit(nums, limit):
    total = 0
    taken = []
    for x in nums:
        print(x)
        if total + x > limit:
            break
        taken.append(x)
        total += x
    return total, taken

print(sum_until_limit([2, 3, 5, 7, 11], 10))

def collect_first_n_even(nums, n):
    res = []
    for x in nums:
        if x % 2 != 0:
            continue
        res.append(x)
        if len(res) == n:
            break
    return res

print(collect_first_n_even([1,2,3,4,6,7,8,10], 3))

def first_index_longer_than(words, k):
    for i, w in enumerate(words):
        if len(w) > k:
            return i
    else:
        return -1

print(first_index_longer_than(["a", "bee", "tree", "oakss"], 4))
print(first_index_longer_than(["a","bb"], 3))

def stats(xs):

    return min(xs), max(xs), sum(xs) / len(xs)

print(stats([3, 1, 7, 5]))

def filter_by_value(d, min_value):
    out = {}
    for k, v in d.items():
        if isinstance(v, (int, float)) and v >= min_value:
            out[k] = v
    return out

scores = {"ua": 90, "math": 75, "phys": 82, "pe": 40}
print(filter_by_value(scores, 80))

def increment_values(d, delta):
    out = {}
    for k, v in d.items():
        if isinstance(v, (int, float)):
            out[k] = v + delta
        else:
            out[k] = v
    return out

prices = {"apple": 10, "pear": 12.5, "note": "N/A"}
print(increment_values(prices, 2))

def select_keys(d, keys):
    out = {}
    for k in keys:
        if k in d:
            out[k] = d[k]
    return out

user = {"id": 1, "name": "Ana", "email": "a@x.io", "role": "admin"}
print(select_keys(user, ["name", "email", "missing"]))

def keys_by_threshold(d, threshold):
    res = []
    for k, v in d.items():
        if isinstance(v, (int, float)) and v >= threshold:
            res.append(k)
    return res

scores = {"ua": 90, "math": 75, "phys": 82, "pe": 40}
print(keys_by_threshold(scores, 80))

def to_frequencies(seq):
    freq = {}
    for x in seq:
        if x in freq:
            freq[x] += 1
        else:
            freq[x] = 1
    return freq

print(to_frequencies(["a","b","a","c","b","a"]))

"""## Типізація параметрів функції (type hints)

Підказки не змінюють виконання, але є хорошою практикою для документування коду


"""

def add(a: int | float, b: int | float) -> int | float:

    return a + b

print(add(2, 3))

print(add('2', '3'))



def filter_even(nums: list[int]) -> list[int]:
    out: list[int] = []
    for n in nums:
        if n % 2 == 0:
            out.append(n)
    return out

print(filter_even([1,2,3,4,5,6]))

def take_until_stopwords(tokens: list[str], stop: set[str]) -> list[str]:
    out: list[str] = []
    for t in tokens:
        if t in stop:
            break
        out.append(t)
    return out

print(take_until_stopwords(["read","parse","STOP","write"], {"STOP"}))  # ['read', 'parse']

def sum_until_limit(nums: list[int], limit: int) -> tuple[int, list[int]]:
    total: int = 0
    taken: list[int] = []
    for x in nums:
        if total + x > limit:
            break
        taken.append(x)
        total += x
    return total, taken

print(sum_until_limit([2, 3, 5, 7, 11], 10))

def collect_first_n_even(nums: list[int], n: int) -> list[int]:
    res: list[int] = []
    for x in nums:
        if x % 2 != 0:
            continue
        res.append(x)
        if len(res) == n:
            break
    return res

print(collect_first_n_even([1,2,3,4,6,7,8,10], 3))

def first_index_longer_than(words: list[str], k: int) -> int:
    for i, w in enumerate(words):
        if len(w) > k:
            return i
    else:
        return -1

print(first_index_longer_than(["a", "bee", "tree", "oak"], 3))
print(first_index_longer_than(["a","bb"], 3))

def stats(xs: list[int | float]) -> tuple[int | float, int | float, float]:
    return min(xs), max(xs), sum(xs) / len(xs)

print(stats([3, 1, 7, 5]))

def filter_by_value(d: dict[str, int | float], min_value: int | float) -> dict[str, int | float]:
    out: dict[str, int | float] = {}
    for k, v in d.items():
        if isinstance(v, (int, float)) and v >= min_value:
            out[k] = v
    return out

scores: dict[str, int] = {"ua": 90, "math": 75, "phys": 82, "pe": 40}
print(filter_by_value(scores, 80))

def increment_values(d: dict[str, int | float], delta: int | float) -> dict[str, int | float]:
    out: dict[str, int | float] = {}
    for k, v in d.items():
        if isinstance(v, (int, float)):
            out[k] = v + delta
        else:
            out[k] = v
    return out

prices: dict[str, int | float] = {"apple": 10, "pear": 12.5, "note": "N/A"}
print(increment_values(prices, 2))

def select_keys(d: dict[str, int | float | str], keys: list[str]) -> dict[str, int | float | str]:
    out: dict[str, int | float | str] = {}
    for k in keys:
        if k in d:
            out[k] = d[k]
    return out

user: dict[str, int | float | str] = {"id": 1, "name": "Ana", "email": "a@x.io", "role": "admin"}
print(select_keys(user, ["name", "email", "missing"]))

def keys_by_threshold(d: dict[str, int | float], threshold: int | float) -> list[str]:
    res: list[str] = []
    for k, v in d.items():
        if isinstance(v, (int, float)) and v >= threshold:
            res.append(k)
    return res

scores = {"ua": 90, "math": 75, "phys": 82, "pe": 40}
print(keys_by_threshold(scores, 80))

def to_frequencies(seq: list[str]) -> dict[str, int]:
    freq: dict[str, int] = {}
    for x in seq:
        if x in freq:
            freq[x] += 1
        else:
            freq[x] = 1
    return freq

print(to_frequencies(["a","b","a","c","b","a"]))



"""## Принципи змінності об’єктів у Python

Незмінні: int, float, str, tuple, frozenset.

Змінні: list, dict, set

Передача значень у функціях — за посиланням на об’єкт

Мутація списку всередині функції змінює оригінал (list — змінний)
"""

def push(xs, x):

    print("in: ", id(xs))
    xs.append(x)

a = [1, 2]
print("out:", id(a))
push(a, 3)
print(a)

"""Переприсвоєння параметра НЕ змінює зовнішній список"""

def replace_list(xs):
    xs = [99, 100]

    return xs


a = [1, 2]
print(id(a))
new = replace_list(a)
print(id(new))

print(a)

"""Рядки (str) — незмінні"""

def make_upper(s):
    s = s.upper()
    return s

name = "anna"
make_upper(name)
print(name)

name = make_upper(name)
print(name)

"""Словник — змінний: зміна значення відбивається назовні"""

def bump_age(user):
    user["age"] = user.get("age", 0) + 1

u = {"name": "Ana", "age": 29}
bump_age(u)
print(u)

"""Копіювання списку для захисту від мутацій параметра"""

def safe_process(xs):
    local = xs.copy()
    local.append(0)
    return sum(local)

arr = [1, 2, 3]
print(safe_process(arr))
print(arr)



"""## Області видимості (LEGB)

L(ocal), E(nclosing), G(lobal), B(uiltins).

global змінює глобальну змінну,

nonlocal — у зовнішній (але не глобальній) області.
"""

x = "G"  # global

def outer():
    x = "E"  # enclosing

    def inner():
        x = "L"  # local
        print("inner:", x)

    inner()
    print("outer:", x)

outer()
print("global:", x)

"""Local"""

x = 50
print(id(x))

def func() -> None:
    x = 2
    print(id(x))
    print('Зміна локального x на', x)

func()
print('Глобальний x як і раніше', x)

"""Enclosing"""

def make_accumulator():
    total = 0
    def add(x):
        nonlocal total
        total += x
        return total
    return add

acc = make_accumulator()
print(acc(5))
print(acc(7))

def discount_price(price, discount):
    def apply_discount():
        nonlocal price
        price = price * (1-discount)

    apply_discount()



    return price

"""Global"""

counter = 0

def inc_global():
    global counter
    counter += 1

inc_global()
print(counter)  # 1

print(type(len))
print(type(sum))
print(type(id))

# def len(my_list):
#     return "length in none"

# len([1,2])

# type(len)

"""## Ключові аргументи функції"""

def func(a, b=5, c=10):
    print('a дорівнює', a,', b дорівнює', b,', а c дорівнює', c)

func(3, 7)

func(25, c=24)

func(c=50, a=100)

def rect_area(width, height=1):
    return width * height

print(rect_area(3, 4))
print(rect_area(width=3))
print(rect_area(height=10, width=2))

def real_cost(base: int, discount: float = 0) -> float:
    return base * (1 - discount)

price_bread = 15
price_butter = 50
price_sugar = 60

current_price_bread = real_cost(price_bread)
current_price_butter = real_cost(price_butter, 0.05)
current_price_sugar = real_cost(price_sugar, 0.07)

print(f'Нова вартість хліба: {current_price_bread}')
print(f'Нова вартість масла: {current_price_butter}')
print(f'Нова вартість цукру: {current_price_sugar}')

"""## Змінна кількість параметрів

`*args` збирає довільну кількість позиційних аргументів у кортеж.

`**kwargs` збирає довільну кількість ключових аргументів у словник.
"""

def summarize(*args, **kwargs):
    return {"args": args, "kwargs": kwargs}

print(summarize(1, 2, 3, mode="sum", verbose=True))

def concatenate(*args) -> str:
    result = ""
    for arg in args:
        result += arg
    return result

print(concatenate("Hello", " ", "world", "!"))

def product(*xs: int) -> int:
    p = 1
    for x in xs:
        p *= x
    return p

print(product(2, 3, 4))

def log_then_call(fn, *args):
    print("calling with:", args)
    return fn(*args)

print(log_then_call(pow, 2, 5))  # 32

def log_then_call(fn, **kwargs):
    print("calling with kwargs:", kwargs)
    return fn(**kwargs)

def pow_kw(**kwargs):
    # очікуємо ключі x, y (і опціонально z)
    x = kwargs["x"]
    y = kwargs["y"]
    z = kwargs.get("z")
    return pow(x, y, z) if z is not None else pow(x, y)


print(log_then_call(pow_kw, x=2, y=5))
print(log_then_call(pow_kw, x=2, y=5, z=7))

"""## Розпакування списків та словників"""

my_list = [1, 2, 3]
a, b, c = my_list

a, _, c = my_list

a, *rest = my_list

def greet(name, age):
    print(f"Hello {name}, you are {age} years old.")

person_info = {"name": "Alice", "age": 25}
greet(**person_info)

def stats(xs):

    return min(xs), max(xs), sum(xs) / len(xs)

print(stats([3, 1, 7, 5]))

"""## Рекурсія"""

def factorial(n):
    if n == 0: # базовий випадок
        return 1
    else:
        return n * factorial(n-1) # рекурсивний випадок

print(factorial(5)) # виведе 120

def fibonacci(n):
    if n <= 1: # базовий випадок
        return n
    else:
        return fibonacci(n-1) + fibonacci(n-2) # рекурсивний випадок

print(fibonacci(10)) # виведе 55

"""#Практика

## Дані
"""

users = {'Іваненко': {'вік': 65,
  'стать': 'чоловік',
  'освіта': 'середня',
  'регіон': 'Північ',
  'сімейний_стан': 'неодружений',
  'дохід': 45969,
  'витрати': 2164,
  'час_на_платформі': 6.0,
  'візити_на_тиждень': 7,
  'пристрої': 3,
  'оцінки': 0.19},
 'Петренко': {'вік': 33,
  'стать': 'чоловік',
  'освіта': 'післядипломна',
  'регіон': 'Північ',
  'сімейний_стан': 'розлучений',
  'дохід': 38826,
  'витрати': 2695,
  'час_на_платформі': 1.9,
  'візити_на_тиждень': 8,
  'пристрої': 2,
  'оцінки': 0.32},
 'Сидорчук': {'вік': 57,
  'стать': 'чоловік',
  'освіта': 'вища',
  'регіон': 'Центр',
  'сімейний_стан': 'розлучений',
  'дохід': 31939,
  'витрати': 3030,
  'час_на_платформі': 6.7,
  'візити_на_тиждень': 23,
  'пристрої': 2,
  'оцінки': 0.15},
 'Коваль': {'вік': 30,
  'стать': 'чоловік',
  'освіта': 'післядипломна',
  'регіон': 'Центр',
  'сімейний_стан': 'розлучений',
  'дохід': 33339,
  'витрати': 2369,
  'час_на_платформі': 6.0,
  'візити_на_тиждень': 22,
  'пристрої': 1,
  'оцінки': 0.7},
 'Мельник': {'вік': 23,
  'стать': 'чоловік',
  'освіта': 'вища',
  'регіон': 'Схід',
  'сімейний_стан': 'неодружений',
  'дохід': 36586,
  'витрати': 3764,
  'час_на_платформі': 6.8,
  'візити_на_тиждень': 10,
  'пристрої': 3,
  'оцінки': 0.38},
 'Ткачук': {'вік': 42,
  'стать': 'чоловік',
  'освіта': 'післядипломна',
  'регіон': 'Центр',
  'сімейний_стан': 'розлучений',
  'дохід': 26729,
  'витрати': 4334,
  'час_на_платформі': 4.6,
  'візити_на_тиждень': 26,
  'пристрої': 2,
  'оцінки': 0.12},
 'Захарченко': {'вік': 40,
  'стать': 'чоловік',
  'освіта': 'післядипломна',
  'регіон': 'Захід',
  'сімейний_стан': 'неодружений',
  'дохід': 46832,
  'витрати': 3710,
  'час_на_платформі': 1.9,
  'візити_на_тиждень': 6,
  'пристрої': 2,
  'оцінки': 0.12},
 'Онищенко': {'вік': 41,
  'стать': 'чоловік',
  'освіта': 'післядипломна',
  'регіон': 'Північ',
  'сімейний_стан': 'одружений',
  'дохід': 41743,
  'витрати': 2091,
  'час_на_платформі': 2.0,
  'візити_на_тиждень': 6,
  'пристрої': 3,
  'оцінки': 0.96},
 'Лисенко': {'вік': 25,
  'стать': 'чоловік',
  'освіта': 'післядипломна',
  'регіон': 'Центр',
  'сімейний_стан': 'одружений',
  'дохід': 37518,
  'витрати': 2612,
  'час_на_платформі': 7.9,
  'візити_на_тиждень': 3,
  'пристрої': 1,
  'оцінки': 0.7},
 'Гончар': {'вік': 63,
  'стать': 'жінка',
  'освіта': 'післядипломна',
  'регіон': 'Центр',
  'сімейний_стан': 'неодружений',
  'дохід': 43297,
  'витрати': 4448,
  'час_на_платформі': 2.7,
  'візити_на_тиждень': 15,
  'пристрої': 1,
  'оцінки': 0.9},
 'Шевченко': {'вік': 41,
  'стать': 'чоловік',
  'освіта': 'середня',
  'регіон': 'Північ',
  'сімейний_стан': 'розлучений',
  'дохід': 36800,
  'витрати': 3846,
  'час_на_платформі': 6.2,
  'візити_на_тиждень': 15,
  'пристрої': 3,
  'оцінки': 0.26},
 'Кузьменко': {'вік': 49,
  'стать': 'жінка',
  'освіта': 'середня',
  'регіон': 'Захід',
  'сімейний_стан': 'розлучений',
  'дохід': 28965,
  'витрати': 3549,
  'час_на_платформі': 2.8,
  'візити_на_тиждень': 21,
  'пристрої': 2,
  'оцінки': 0.63},
 'Романюк': {'вік': 60,
  'стать': 'чоловік',
  'освіта': 'післядипломна',
  'регіон': 'Північ',
  'сімейний_стан': 'неодружений',
  'дохід': 36593,
  'витрати': 2365,
  'час_на_платформі': 6.7,
  'візити_на_тиждень': 10,
  'пристрої': 2,
  'оцінки': 0.25},
 'Бондар': {'вік': 48,
  'стать': 'жінка',
  'освіта': 'середня',
  'регіон': 'Центр',
  'сімейний_стан': 'неодружений',
  'дохід': 35114,
  'витрати': 3259,
  'час_на_платформі': 2.2,
  'візити_на_тиждень': 17,
  'пристрої': 2,
  'оцінки': 0.06},
 'Кравець': {'вік': 19,
  'стать': 'чоловік',
  'освіта': 'середня',
  'регіон': 'Захід',
  'сімейний_стан': 'неодружений',
  'дохід': 23578,
  'витрати': 4174,
  'час_на_платформі': 3.3,
  'візити_на_тиждень': 11,
  'пристрої': 2,
  'оцінки': 0.87},
 'Білоус': {'вік': 29,
  'стать': 'чоловік',
  'освіта': 'середня',
  'регіон': 'Схід',
  'сімейний_стан': 'одружений',
  'дохід': 38478,
  'витрати': 2192,
  'час_на_платформі': 7.4,
  'візити_на_тиждень': 26,
  'пристрої': 1,
  'оцінки': 0.78},
 'Черненко': {'вік': 64,
  'стать': 'чоловік',
  'освіта': 'вища',
  'регіон': 'Центр',
  'сімейний_стан': 'розлучений',
  'дохід': 36693,
  'витрати': 4209,
  'час_на_платформі': 1.3,
  'візити_на_тиждень': 26,
  'пристрої': 1,
  'оцінки': 0.29},
 'Кириленко': {'вік': 20,
  'стать': 'жінка',
  'освіта': 'середня',
  'регіон': 'Захід',
  'сімейний_стан': 'неодружений',
  'дохід': 37914,
  'витрати': 2459,
  'час_на_платформі': 5.1,
  'візити_на_тиждень': 22,
  'пристрої': 1,
  'оцінки': 0.89},
 'Бондаренко': {'вік': 22,
  'стать': 'чоловік',
  'освіта': 'середня',
  'регіон': 'Північ',
  'сімейний_стан': 'неодружений',
  'дохід': 41941,
  'витрати': 2707,
  'час_на_платформі': 4.3,
  'візити_на_тиждень': 14,
  'пристрої': 1,
  'оцінки': 0.98},
 'Мороз': {'вік': 49,
  'стать': 'чоловік',
  'освіта': 'середня',
  'регіон': 'Схід',
  'сімейний_стан': 'неодружений',
  'дохід': 38128,
  'витрати': 4923,
  'час_на_платформі': 1.0,
  'візити_на_тиждень': 29,
  'пристрої': 3,
  'оцінки': 0.28},
 'Мартинюк': {'вік': 31,
  'стать': 'жінка',
  'освіта': 'середня',
  'регіон': 'Північ',
  'сімейний_стан': 'одружений',
  'дохід': 46579,
  'витрати': 4206,
  'час_на_платформі': 3.3,
  'візити_на_тиждень': 20,
  'пристрої': 2,
  'оцінки': 0.55},
 'Хоменко': {'вік': 51,
  'стать': 'жінка',
  'освіта': 'вища',
  'регіон': 'Схід',
  'сімейний_стан': 'розлучений',
  'дохід': 39829,
  'витрати': 4922,
  'час_на_платформі': 5.8,
  'візити_на_тиждень': 30,
  'пристрої': 1,
  'оцінки': 0.98},
 'Левченко': {'вік': 46,
  'стать': 'жінка',
  'освіта': 'середня',
  'регіон': 'Захід',
  'сімейний_стан': 'неодружений',
  'дохід': 31024,
  'витрати': 2559,
  'час_на_платформі': 0.7,
  'візити_на_тиждень': 29,
  'пристрої': 2,
  'оцінки': 0.34},
 'Федорчук': {'вік': 62,
  'стать': 'чоловік',
  'освіта': 'середня',
  'регіон': 'Захід',
  'сімейний_стан': 'одружений',
  'дохід': 32835,
  'витрати': 4247,
  'час_на_платформі': 3.9,
  'візити_на_тиждень': 16,
  'пристрої': 1,
  'оцінки': 0.65},
 'Юрченко': {'вік': 35,
  'стать': 'жінка',
  'освіта': 'вища',
  'регіон': 'Північ',
  'сімейний_стан': 'одружений',
  'дохід': 30850,
  'витрати': 3091,
  'час_на_платформі': 4.4,
  'візити_на_тиждень': 17,
  'пристрої': 3,
  'оцінки': 0.87},
 'Зінченко': {'вік': 21,
  'стать': 'чоловік',
  'освіта': 'післядипломна',
  'регіон': 'Схід',
  'сімейний_стан': 'розлучений',
  'дохід': 22792,
  'витрати': 3263,
  'час_на_платформі': 7.2,
  'візити_на_тиждень': 11,
  'пристрої': 2,
  'оцінки': 0.46},
 'Білик': {'вік': 52,
  'стать': 'жінка',
  'освіта': 'післядипломна',
  'регіон': 'Центр',
  'сімейний_стан': 'неодружений',
  'дохід': 24462,
  'витрати': 2749,
  'час_на_платформі': 5.5,
  'візити_на_тиждень': 13,
  'пристрої': 3,
  'оцінки': 0.38},
 'Герасименко': {'вік': 51,
  'стать': 'жінка',
  'освіта': 'вища',
  'регіон': 'Захід',
  'сімейний_стан': 'неодружений',
  'дохід': 30200,
  'витрати': 4784,
  'час_на_платформі': 6.4,
  'візити_на_тиждень': 14,
  'пристрої': 1,
  'оцінки': 0.15},
 'Литвин': {'вік': 24,
  'стать': 'чоловік',
  'освіта': 'післядипломна',
  'регіон': 'Північ',
  'сімейний_стан': 'неодружений',
  'дохід': 43621,
  'витрати': 2326,
  'час_на_платформі': 0.9,
  'візити_на_тиждень': 18,
  'пристрої': 1,
  'оцінки': 0.23},
 'Терещенко': {'вік': 45,
  'стать': 'жінка',
  'освіта': 'післядипломна',
  'регіон': 'Схід',
  'сімейний_стан': 'одружений',
  'дохід': 31237,
  'витрати': 2935,
  'час_на_платформі': 2.4,
  'візити_на_тиждень': 13,
  'пристрої': 1,
  'оцінки': 0.82},
 'Яременко': {'вік': 40,
  'стать': 'жінка',
  'освіта': 'вища',
  'регіон': 'Схід',
  'сімейний_стан': 'розлучений',
  'дохід': 42962,
  'витрати': 2206,
  'час_на_платформі': 7.4,
  'візити_на_тиждень': 18,
  'пристрої': 2,
  'оцінки': 0.82},
 'Тимченко': {'вік': 46,
  'стать': 'жінка',
  'освіта': 'вища',
  'регіон': 'Схід',
  'сімейний_стан': 'розлучений',
  'дохід': 25833,
  'витрати': 2312,
  'час_на_платформі': 6.5,
  'візити_на_тиждень': 1,
  'пристрої': 2,
  'оцінки': 0.98},
 'Калініченко': {'вік': 23,
  'стать': 'жінка',
  'освіта': 'вища',
  'регіон': 'Південь',
  'сімейний_стан': 'одружений',
  'дохід': 25405,
  'витрати': 4751,
  'час_на_платформі': 1.0,
  'візити_на_тиждень': 27,
  'пристрої': 1,
  'оцінки': 0.75},
 'Гриненко': {'вік': 29,
  'стать': 'жінка',
  'освіта': 'середня',
  'регіон': 'Схід',
  'сімейний_стан': 'одружений',
  'дохід': 25638,
  'витрати': 4396,
  'час_на_платформі': 2.6,
  'візити_на_тиждень': 24,
  'пристрої': 2,
  'оцінки': 0.05},
 'Коломієць': {'вік': 38,
  'стать': 'чоловік',
  'освіта': 'середня',
  'регіон': 'Південь',
  'сімейний_стан': 'неодружений',
  'дохід': 39275,
  'витрати': 2960,
  'час_на_платформі': 2.0,
  'візити_на_тиждень': 12,
  'пристрої': 3,
  'оцінки': 0.87},
 'Гнатенко': {'вік': 54,
  'стать': 'чоловік',
  'освіта': 'післядипломна',
  'регіон': 'Захід',
  'сімейний_стан': 'розлучений',
  'дохід': 47331,
  'витрати': 4453,
  'час_на_платформі': 4.8,
  'візити_на_тиждень': 3,
  'пристрої': 1,
  'оцінки': 0.8},
 'Коваленко': {'вік': 34,
  'стать': 'чоловік',
  'освіта': 'середня',
  'регіон': 'Північ',
  'сімейний_стан': 'одружений',
  'дохід': 38543,
  'витрати': 3640,
  'час_на_платформі': 6.6,
  'візити_на_тиждень': 13,
  'пристрої': 1,
  'оцінки': 0.45},
 'Журавель': {'вік': 25,
  'стать': 'чоловік',
  'освіта': 'середня',
  'регіон': 'Захід',
  'сімейний_стан': 'розлучений',
  'дохід': 46411,
  'витрати': 2379,
  'час_на_платформі': 4.8,
  'візити_на_тиждень': 19,
  'пристрої': 2,
  'оцінки': 0.89},
 'Мазур': {'вік': 52,
  'стать': 'жінка',
  'освіта': 'середня',
  'регіон': 'Схід',
  'сімейний_стан': 'неодружений',
  'дохід': 47636,
  'витрати': 2176,
  'час_на_платформі': 4.6,
  'візити_на_тиждень': 22,
  'пристрої': 2,
  'оцінки': 0.38},
 'Савченко': {'вік': 29,
  'стать': 'чоловік',
  'освіта': 'вища',
  'регіон': 'Центр',
  'сімейний_стан': 'одружений',
  'дохід': 22962,
  'витрати': 2866,
  'час_на_платформі': 2.4,
  'візити_на_тиждень': 30,
  'пристрої': 1,
  'оцінки': 0.29},
 'Семененко': {'вік': 58,
  'стать': 'чоловік',
  'освіта': 'вища',
  'регіон': 'Схід',
  'сімейний_стан': 'одружений',
  'дохід': 42717,
  'витрати': 3887,
  'час_на_платформі': 3.2,
  'візити_на_тиждень': 4,
  'пристрої': 1,
  'оцінки': 0.42},
 'Данилюк': {'вік': 28,
  'стать': 'чоловік',
  'освіта': 'середня',
  'регіон': 'Захід',
  'сімейний_стан': 'неодружений',
  'дохід': 48343,
  'витрати': 3051,
  'час_на_платформі': 3.0,
  'візити_на_тиждень': 25,
  'пристрої': 1,
  'оцінки': 0.77},
 'Горбунов': {'вік': 48,
  'стать': 'чоловік',
  'освіта': 'середня',
  'регіон': 'Захід',
  'сімейний_стан': 'розлучений',
  'дохід': 37159,
  'витрати': 4794,
  'час_на_платформі': 2.0,
  'візити_на_тиждень': 26,
  'пристрої': 1,
  'оцінки': 0.47},
 'Павленко': {'вік': 32,
  'стать': 'чоловік',
  'освіта': 'вища',
  'регіон': 'Захід',
  'сімейний_стан': 'одружений',
  'дохід': 38074,
  'витрати': 4603,
  'час_на_платформі': 5.8,
  'візити_на_тиждень': 12,
  'пристрої': 1,
  'оцінки': 0.72},
 'Гайдай': {'вік': 67,
  'стать': 'жінка',
  'освіта': 'післядипломна',
  'регіон': 'Схід',
  'сімейний_стан': 'неодружений',
  'дохід': 48780,
  'витрати': 4931,
  'час_на_платформі': 5.8,
  'візити_на_тиждень': 1,
  'пристрої': 1,
  'оцінки': 0.55},
 'Вовк': {'вік': 59,
  'стать': 'чоловік',
  'освіта': 'середня',
  'регіон': 'Схід',
  'сімейний_стан': 'одружений',
  'дохід': 34261,
  'витрати': 4273,
  'час_на_платформі': 1.4,
  'візити_на_тиждень': 21,
  'пристрої': 3,
  'оцінки': 0.65},
 'Рибалко': {'вік': 23,
  'стать': 'чоловік',
  'освіта': 'середня',
  'регіон': 'Південь',
  'сімейний_стан': 'одружений',
  'дохід': 30350,
  'витрати': 2494,
  'час_на_платформі': 2.0,
  'візити_на_тиждень': 17,
  'пристрої': 3,
  'оцінки': 0.56},
 'Макаренко': {'вік': 51,
  'стать': 'жінка',
  'освіта': 'середня',
  'регіон': 'Захід',
  'сімейний_стан': 'розлучений',
  'дохід': 45196,
  'витрати': 2277,
  'час_на_платформі': 5.3,
  'візити_на_тиждень': 1,
  'пристрої': 1,
  'оцінки': 0.62},
 'Ніколайчук': {'вік': 45,
  'стать': 'чоловік',
  'освіта': 'середня',
  'регіон': 'Схід',
  'сімейний_стан': 'одружений',
  'дохід': 43758,
  'витрати': 3488,
  'час_на_платформі': 2.3,
  'візити_на_тиждень': 24,
  'пристрої': 1,
  'оцінки': 0.46},
 'Бондар-239': {'вік': 23,
  'стать': 'жінка',
  'освіта': 'вища',
  'регіон': 'Захід',
  'сімейний_стан': 'неодружений',
  'дохід': 42932,
  'витрати': 2375,
  'час_на_платформі': 6.1,
  'візити_на_тиждень': 28,
  'пристрої': 2,
  'оцінки': 0.81},
 'Петренко-732': {'вік': 44,
  'стать': 'чоловік',
  'освіта': 'післядипломна',
  'регіон': 'Північ',
  'сімейний_стан': 'одружений',
  'дохід': 42751,
  'витрати': 3400,
  'час_на_платформі': 8.0,
  'візити_на_тиждень': 29,
  'пристрої': 3,
  'оцінки': 0.71},
 'Данилюк-761': {'вік': 20,
  'стать': 'чоловік',
  'освіта': 'післядипломна',
  'регіон': 'Захід',
  'сімейний_стан': 'неодружений',
  'дохід': 21237,
  'витрати': 3917,
  'час_на_платформі': 3.9,
  'візити_на_тиждень': 27,
  'пристрої': 2,
  'оцінки': 0.77},
 'Журавель-509': {'вік': 26,
  'стать': 'жінка',
  'освіта': 'вища',
  'регіон': 'Захід',
  'сімейний_стан': 'розлучений',
  'дохід': 26866,
  'витрати': 4828,
  'час_на_платформі': 4.7,
  'візити_на_тиждень': 3,
  'пристрої': 1,
  'оцінки': 0.08},
 'Гриненко-481': {'вік': 38,
  'стать': 'чоловік',
  'освіта': 'вища',
  'регіон': 'Центр',
  'сімейний_стан': 'розлучений',
  'дохід': 23560,
  'витрати': 4032,
  'час_на_платформі': 1.1,
  'візити_на_тиждень': 12,
  'пристрої': 2,
  'оцінки': 0.45},
 'Черненко-339': {'вік': 48,
  'стать': 'чоловік',
  'освіта': 'післядипломна',
  'регіон': 'Центр',
  'сімейний_стан': 'одружений',
  'дохід': 24699,
  'витрати': 4302,
  'час_на_платформі': 2.0,
  'візити_на_тиждень': 22,
  'пристрої': 3,
  'оцінки': 0.81},
 'Мазур-436': {'вік': 28,
  'стать': 'жінка',
  'освіта': 'післядипломна',
  'регіон': 'Схід',
  'сімейний_стан': 'одружений',
  'дохід': 37756,
  'витрати': 3717,
  'час_на_платформі': 7.5,
  'візити_на_тиждень': 4,
  'пристрої': 2,
  'оцінки': 0.15},
 'Кравець-101': {'вік': 42,
  'стать': 'жінка',
  'освіта': 'середня',
  'регіон': 'Центр',
  'сімейний_стан': 'одружений',
  'дохід': 34355,
  'витрати': 3743,
  'час_на_платформі': 4.9,
  'візити_на_тиждень': 7,
  'пристрої': 2,
  'оцінки': 0.99},
 'Федорчук-372': {'вік': 54,
  'стать': 'чоловік',
  'освіта': 'вища',
  'регіон': 'Північ',
  'сімейний_стан': 'розлучений',
  'дохід': 33796,
  'витрати': 2006,
  'час_на_платформі': 3.6,
  'візити_на_тиждень': 13,
  'пристрої': 3,
  'оцінки': 0.21},
 'Вовк-285': {'вік': 38,
  'стать': 'чоловік',
  'освіта': 'середня',
  'регіон': 'Центр',
  'сімейний_стан': 'одружений',
  'дохід': 44790,
  'витрати': 2763,
  'час_на_платформі': 1.1,
  'візити_на_тиждень': 3,
  'пристрої': 3,
  'оцінки': 0.17},
 'Федорчук-843': {'вік': 27,
  'стать': 'чоловік',
  'освіта': 'післядипломна',
  'регіон': 'Захід',
  'сімейний_стан': 'неодружений',
  'дохід': 25378,
  'витрати': 3584,
  'час_на_платформі': 1.1,
  'візити_на_тиждень': 4,
  'пристрої': 3,
  'оцінки': 0.26},
 'Вовк-615': {'вік': 23,
  'стать': 'жінка',
  'освіта': 'вища',
  'регіон': 'Схід',
  'сімейний_стан': 'одружений',
  'дохід': 49398,
  'витрати': 3489,
  'час_на_платформі': 6.6,
  'візити_на_тиждень': 2,
  'пристрої': 3,
  'оцінки': 0.54},
 'Гриненко-61': {'вік': 63,
  'стать': 'чоловік',
  'освіта': 'вища',
  'регіон': 'Південь',
  'сімейний_стан': 'неодружений',
  'дохід': 34111,
  'витрати': 3364,
  'час_на_платформі': 3.7,
  'візити_на_тиждень': 16,
  'пристрої': 1,
  'оцінки': 0.66},
 'Литвин-728': {'вік': 51,
  'стать': 'жінка',
  'освіта': 'вища',
  'регіон': 'Південь',
  'сімейний_стан': 'одружений',
  'дохід': 21476,
  'витрати': 4961,
  'час_на_платформі': 5.3,
  'візити_на_тиждень': 21,
  'пристрої': 2,
  'оцінки': 0.17},
 'Онищенко-495': {'вік': 53,
  'стать': 'чоловік',
  'освіта': 'вища',
  'регіон': 'Схід',
  'сімейний_стан': 'неодружений',
  'дохід': 34525,
  'витрати': 3651,
  'час_на_платформі': 3.2,
  'візити_на_тиждень': 28,
  'пристрої': 3,
  'оцінки': 0.19},
 'Яременко-10': {'вік': 18,
  'стать': 'жінка',
  'освіта': 'вища',
  'регіон': 'Захід',
  'сімейний_стан': 'одружений',
  'дохід': 48423,
  'витрати': 2190,
  'час_на_платформі': 3.7,
  'візити_на_тиждень': 20,
  'пристрої': 1,
  'оцінки': 0.11},
 'Горбунов-686': {'вік': 34,
  'стать': 'чоловік',
  'освіта': 'середня',
  'регіон': 'Південь',
  'сімейний_стан': 'розлучений',
  'дохід': 43200,
  'витрати': 2187,
  'час_на_платформі': 4.6,
  'візити_на_тиждень': 21,
  'пристрої': 2,
  'оцінки': 0.86},
 'Данилюк-686': {'вік': 59,
  'стать': 'чоловік',
  'освіта': 'середня',
  'регіон': 'Захід',
  'сімейний_стан': 'неодружений',
  'дохід': 34342,
  'витрати': 2509,
  'час_на_платформі': 5.1,
  'візити_на_тиждень': 20,
  'пристрої': 2,
  'оцінки': 0.91},
 'Гайдай-609': {'вік': 68,
  'стать': 'чоловік',
  'освіта': 'середня',
  'регіон': 'Захід',
  'сімейний_стан': 'одружений',
  'дохід': 36495,
  'витрати': 3808,
  'час_на_платформі': 3.3,
  'візити_на_тиждень': 10,
  'пристрої': 3,
  'оцінки': 0.7},
 'Горбунов-377': {'вік': 41,
  'стать': 'жінка',
  'освіта': 'післядипломна',
  'регіон': 'Північ',
  'сімейний_стан': 'розлучений',
  'дохід': 20446,
  'витрати': 4221,
  'час_на_платформі': 1.4,
  'візити_на_тиждень': 29,
  'пристрої': 3,
  'оцінки': 0.2},
 'Шевченко-620': {'вік': 32,
  'стать': 'чоловік',
  'освіта': 'середня',
  'регіон': 'Захід',
  'сімейний_стан': 'одружений',
  'дохід': 35519,
  'витрати': 3351,
  'час_на_платформі': 6.4,
  'візити_на_тиждень': 14,
  'пристрої': 3,
  'оцінки': 0.5},
 'Мороз-235': {'вік': 50,
  'стать': 'чоловік',
  'освіта': 'вища',
  'регіон': 'Схід',
  'сімейний_стан': 'одружений',
  'дохід': 46162,
  'витрати': 2465,
  'час_на_платформі': 4.4,
  'візити_на_тиждень': 28,
  'пристрої': 3,
  'оцінки': 0.2},
 'Бондар-8': {'вік': 26,
  'стать': 'жінка',
  'освіта': 'післядипломна',
  'регіон': 'Захід',
  'сімейний_стан': 'одружений',
  'дохід': 20897,
  'витрати': 3957,
  'час_на_платформі': 5.1,
  'візити_на_тиждень': 30,
  'пристрої': 2,
  'оцінки': 0.66},
 'Юрченко-956': {'вік': 53,
  'стать': 'жінка',
  'освіта': 'вища',
  'регіон': 'Захід',
  'сімейний_стан': 'одружений',
  'дохід': 43097,
  'витрати': 4223,
  'час_на_платформі': 2.6,
  'візити_на_тиждень': 22,
  'пристрої': 2,
  'оцінки': 0.09},
 'Савченко-960': {'вік': 44,
  'стать': 'жінка',
  'освіта': 'вища',
  'регіон': 'Схід',
  'сімейний_стан': 'одружений',
  'дохід': 45551,
  'витрати': 3650,
  'час_на_платформі': 5.4,
  'візити_на_тиждень': 19,
  'пристрої': 2,
  'оцінки': 0.97},
 'Литвин-733': {'вік': 58,
  'стать': 'жінка',
  'освіта': 'післядипломна',
  'регіон': 'Південь',
  'сімейний_стан': 'одружений',
  'дохід': 20425,
  'витрати': 4487,
  'час_на_платформі': 1.0,
  'візити_на_тиждень': 17,
  'пристрої': 1,
  'оцінки': 0.58},
 'Мазур-241': {'вік': 62,
  'стать': 'чоловік',
  'освіта': 'вища',
  'регіон': 'Схід',
  'сімейний_стан': 'одружений',
  'дохід': 38090,
  'витрати': 4465,
  'час_на_платформі': 7.5,
  'візити_на_тиждень': 25,
  'пристрої': 1,
  'оцінки': 0.32},
 'Юрченко-657': {'вік': 39,
  'стать': 'жінка',
  'освіта': 'післядипломна',
  'регіон': 'Північ',
  'сімейний_стан': 'одружений',
  'дохід': 24616,
  'витрати': 4013,
  'час_на_платформі': 4.9,
  'візити_на_тиждень': 30,
  'пристрої': 2,
  'оцінки': 0.58},
 'Кравець-794': {'вік': 46,
  'стать': 'жінка',
  'освіта': 'середня',
  'регіон': 'Захід',
  'сімейний_стан': 'одружений',
  'дохід': 46688,
  'витрати': 2634,
  'час_на_платформі': 7.5,
  'візити_на_тиждень': 7,
  'пристрої': 1,
  'оцінки': 0.06},
 'Мороз-453': {'вік': 19,
  'стать': 'чоловік',
  'освіта': 'середня',
  'регіон': 'Південь',
  'сімейний_стан': 'розлучений',
  'дохід': 39908,
  'витрати': 4322,
  'час_на_платформі': 4.3,
  'візити_на_тиждень': 7,
  'пристрої': 3,
  'оцінки': 0.31},
 'Левченко-771': {'вік': 19,
  'стать': 'чоловік',
  'освіта': 'післядипломна',
  'регіон': 'Південь',
  'сімейний_стан': 'розлучений',
  'дохід': 49241,
  'витрати': 2755,
  'час_на_платформі': 6.3,
  'візити_на_тиждень': 11,
  'пристрої': 2,
  'оцінки': 0.36},
 'Шевченко-52': {'вік': 19,
  'стать': 'жінка',
  'освіта': 'післядипломна',
  'регіон': 'Схід',
  'сімейний_стан': 'неодружений',
  'дохід': 21655,
  'витрати': 2204,
  'час_на_платформі': 6.6,
  'візити_на_тиждень': 19,
  'пристрої': 3,
  'оцінки': 0.73},
 'Гайдай-568': {'вік': 62,
  'стать': 'жінка',
  'освіта': 'вища',
  'регіон': 'Північ',
  'сімейний_стан': 'розлучений',
  'дохід': 29745,
  'витрати': 2955,
  'час_на_платформі': 6.6,
  'візити_на_тиждень': 19,
  'пристрої': 3,
  'оцінки': 0.81},
 'Коваленко-68': {'вік': 50,
  'стать': 'чоловік',
  'освіта': 'післядипломна',
  'регіон': 'Північ',
  'сімейний_стан': 'розлучений',
  'дохід': 31454,
  'витрати': 2290,
  'час_на_платформі': 5.4,
  'візити_на_тиждень': 14,
  'пристрої': 1,
  'оцінки': 0.93},
 'Яременко-258': {'вік': 63,
  'стать': 'жінка',
  'освіта': 'середня',
  'регіон': 'Північ',
  'сімейний_стан': 'неодружений',
  'дохід': 34128,
  'витрати': 2386,
  'час_на_платформі': 4.9,
  'візити_на_тиждень': 17,
  'пристрої': 2,
  'оцінки': 0.91},
 'Левченко-847': {'вік': 65,
  'стать': 'жінка',
  'освіта': 'вища',
  'регіон': 'Захід',
  'сімейний_стан': 'одружений',
  'дохід': 49217,
  'витрати': 2212,
  'час_на_платформі': 2.5,
  'візити_на_тиждень': 14,
  'пристрої': 3,
  'оцінки': 0.87},
 'Гайдай-402': {'вік': 22,
  'стать': 'чоловік',
  'освіта': 'середня',
  'регіон': 'Північ',
  'сімейний_стан': 'одружений',
  'дохід': 36010,
  'витрати': 3002,
  'час_на_платформі': 7.3,
  'візити_на_тиждень': 18,
  'пристрої': 3,
  'оцінки': 0.86},
 'Сидорчук-124': {'вік': 59,
  'стать': 'чоловік',
  'освіта': 'вища',
  'регіон': 'Центр',
  'сімейний_стан': 'розлучений',
  'дохід': 22330,
  'витрати': 4189,
  'час_на_платформі': 5.5,
  'візити_на_тиждень': 19,
  'пристрої': 2,
  'оцінки': 0.68},
 'Гриненко-497': {'вік': 51,
  'стать': 'жінка',
  'освіта': 'вища',
  'регіон': 'Захід',
  'сімейний_стан': 'одружений',
  'дохід': 37659,
  'витрати': 3433,
  'час_на_платформі': 4.0,
  'візити_на_тиждень': 24,
  'пристрої': 1,
  'оцінки': 0.57},
 'Білик-277': {'вік': 35,
  'стать': 'чоловік',
  'освіта': 'вища',
  'регіон': 'Південь',
  'сімейний_стан': 'неодружений',
  'дохід': 26468,
  'витрати': 4817,
  'час_на_платформі': 5.3,
  'візити_на_тиждень': 26,
  'пристрої': 2,
  'оцінки': 0.69},
 'Черненко-533': {'вік': 54,
  'стать': 'жінка',
  'освіта': 'післядипломна',
  'регіон': 'Захід',
  'сімейний_стан': 'розлучений',
  'дохід': 25815,
  'витрати': 2227,
  'час_на_платформі': 4.3,
  'візити_на_тиждень': 30,
  'пристрої': 2,
  'оцінки': 0.21},
 'Білоус-148': {'вік': 42,
  'стать': 'жінка',
  'освіта': 'післядипломна',
  'регіон': 'Захід',
  'сімейний_стан': 'неодружений',
  'дохід': 30940,
  'витрати': 2412,
  'час_на_платформі': 1.1,
  'візити_на_тиждень': 6,
  'пристрої': 2,
  'оцінки': 0.81},
 'Журавель-381': {'вік': 57,
  'стать': 'чоловік',
  'освіта': 'середня',
  'регіон': 'Захід',
  'сімейний_стан': 'одружений',
  'дохід': 32143,
  'витрати': 3037,
  'час_на_платформі': 3.3,
  'візити_на_тиждень': 10,
  'пристрої': 2,
  'оцінки': 0.12},
 'Калініченко-259': {'вік': 35,
  'стать': 'чоловік',
  'освіта': 'вища',
  'регіон': 'Захід',
  'сімейний_стан': 'розлучений',
  'дохід': 43042,
  'витрати': 2265,
  'час_на_платформі': 4.1,
  'візити_на_тиждень': 16,
  'пристрої': 3,
  'оцінки': 0.83},
 'Семененко-481': {'вік': 24,
  'стать': 'чоловік',
  'освіта': 'середня',
  'регіон': 'Схід',
  'сімейний_стан': 'одружений',
  'дохід': 48575,
  'витрати': 3757,
  'час_на_платформі': 4.9,
  'візити_на_тиждень': 3,
  'пристрої': 1,
  'оцінки': 0.44},
 'Данилюк-259': {'вік': 34,
  'стать': 'жінка',
  'освіта': 'середня',
  'регіон': 'Захід',
  'сімейний_стан': 'одружений',
  'дохід': 21986,
  'витрати': 3658,
  'час_на_платформі': 3.6,
  'візити_на_тиждень': 2,
  'пристрої': 3,
  'оцінки': 0.81},
 'Мазур-30': {'вік': 20,
  'стать': 'жінка',
  'освіта': 'післядипломна',
  'регіон': 'Північ',
  'сімейний_стан': 'неодружений',
  'дохід': 31135,
  'витрати': 2735,
  'час_на_платформі': 6.8,
  'візити_на_тиждень': 24,
  'пристрої': 3,
  'оцінки': 0.82},
 'Левченко-738': {'вік': 69,
  'стать': 'жінка',
  'освіта': 'середня',
  'регіон': 'Південь',
  'сімейний_стан': 'неодружений',
  'дохід': 21396,
  'витрати': 4014,
  'час_на_платформі': 7.1,
  'візити_на_тиждень': 13,
  'пристрої': 2,
  'оцінки': 0.83},
 'Гриненко-598': {'вік': 56,
  'стать': 'жінка',
  'освіта': 'післядипломна',
  'регіон': 'Північ',
  'сімейний_стан': 'неодружений',
  'дохід': 46049,
  'витрати': 3683,
  'час_на_платформі': 2.2,
  'візити_на_тиждень': 19,
  'пристрої': 2,
  'оцінки': 0.65},
 'Гриненко-842': {'вік': 25,
  'стать': 'жінка',
  'освіта': 'вища',
  'регіон': 'Захід',
  'сімейний_стан': 'одружений',
  'дохід': 24678,
  'витрати': 2898,
  'час_на_платформі': 7.4,
  'візити_на_тиждень': 5,
  'пристрої': 2,
  'оцінки': 0.04},
 'Коломієць-603': {'вік': 21,
  'стать': 'чоловік',
  'освіта': 'середня',
  'регіон': 'Захід',
  'сімейний_стан': 'неодружений',
  'дохід': 37207,
  'витрати': 4307,
  'час_на_платформі': 2.2,
  'візити_на_тиждень': 14,
  'пристрої': 1,
  'оцінки': 0.24}}

len(users)

users.keys()

for surname, info in users.items():
    print(f"{surname}: {list(info.keys())}")

"""## Задачі

1. Знайти користувачів із коефіцієнтом витрат (витрати/дохід) > 0.2
"""

list(users.items())[0]

def users_with_expense_ratio(users, threshold=0.2):
    res = []
    for surname, u in users.items():
        inc = u.get("дохід")
        exp = u.get("витрати")
        if isinstance(inc, (int, float)) and inc > 0 and isinstance(exp, (int, float)):
            if exp / inc > threshold:
                res.append((surname, exp, inc))
    return res

print("1:", users_with_expense_ratio(users, 0.2))

users["Литвин-728"]

4961 / 21476

"""2. Середній рівень оцінок для одружених користувачів із Центру:"""

def avg_scores_for(users, marital="одружений", region="Центр"):
    total = 0.0
    cnt = 0
    for u in users.values():
        if u.get("сімейний_стан") == marital and u.get("регіон") == region:
            sc = u.get("оцінки")
            if isinstance(sc, (int, float)):
                total += float(sc)
                cnt += 1
    return (total / cnt) if cnt else None

print("2:", avg_scores_for(users, marital="одружений", region="Центр"))

"""3. Користувачі які мають найбільшу кількість візитів на тиждень і понад 2 пристрої?"""

def max_visits_with_min_devices(users, min_devices=2):
    maxv = None
    for u in users.values():
        dev = u.get("пристрої")
        vis = u.get("візити_на_тиждень")
        if isinstance(dev, int) and dev > min_devices and isinstance(vis, int):
            if maxv is None or vis > maxv:
                maxv = vis
    if maxv is None:
        return []
    return [s for s, u in users.items()
            if isinstance(u.get("пристрої"), int) and u.get("пристрої") > min_devices
            and isinstance(u.get("візити_на_тиждень"), int) and u.get("візити_на_тиждень") == maxv]

print("3:", max_visits_with_min_devices(users, min_devices=2))

users["Мороз"]

users["Петренко-732"]

users["Горбунов-377"]

"""4. Побудувати словник: Прізвище → добуток оцінки × кількість візитів"""

def interaction_scores(users, round_to=2):
    out = {}
    for s, u in users.items():
        sc = u.get("оцінки")
        vis = u.get("візити_на_тиждень")
        sc = float(sc) if isinstance(sc, (int, float)) else 0.0
        vis = float(vis) if isinstance(vis, (int, float)) else 0.0
        out[s] = round(sc * vis, round_to)
    return out

print("4:", list(interaction_scores(users).items())[:5])

"""5. Знайти користувачів, у яких витрати перевищують дохід"""

def overspenders(users):
    res = []
    for s, u in users.items():
        exp = u.get("витрати")
        inc = u.get("дохід")
        if isinstance(exp, (int, float)) and isinstance(inc, (int, float)) and exp > inc:
            res.append(s)
    return res

print("5:", overspenders(users))

"""6. Обчислити середній дохід для кожного рівня освіти"""

def average_income_by_education(users, round_to=2):
    totals, counts = {}, {}
    for u in users.values():
        edu = u.get("освіта")
        inc = u.get("дохід")
        if isinstance(inc, (int, float)):
            if edu not in totals:
                totals[edu] = 0.0
                counts[edu] = 0
            totals[edu] += float(inc)
            counts[edu] += 1
    return {edu: round(totals[edu] / counts[edu], round_to) for edu in totals if counts[edu]}


print("6:", average_income_by_education(users))

"""7. Користувачі, які проводять на сайті понад 3 години щодня"""

def heavy_time_users(users, min_hours=3.0):
    res = []
    for s, u in users.items():
        t = u.get("час_на_платформі")
        if isinstance(t, (int, float)) and float(t) > float(min_hours):
            res.append((s, t))
    return res

print("7:", heavy_time_users(users, 3))

"""8. Скільки жінок з вищою освітою мають дохід понад 20 000 грн"""

def count_women_higher_edu_high_income(users, min_income=20000, gender="жінка", edu="вища"):
    c = 0
    for u in users.values():
        if u.get("стать") == gender and u.get("освіта") == edu:
            inc = u.get("дохід")
            if isinstance(inc, (int, float)) and inc > min_income:
                c += 1
    return c

print("8:", count_women_higher_edu_high_income(users, 20000))

"""9. Користувачі віком до 30 років"""

def users_under_age(users, max_age=30):
    res = []
    for s, u in users.items():
        age = u.get("вік")
        if isinstance(age, int) and age <= int(max_age):
            res.append((s, age))
    return res

print("9:", users_under_age(users, 30))

"""10. Знайти користувачів, які одночасно:

мають вищу або післядипломну освіту

неодружені

використовують більше одного пристрою

і при цьому мають оцінку > 0.8
"""

def users_multi_criteria(users,
                         edu_levels=("вища", "післядипломна"),
                         marital="неодружений",
                         min_devices=1,
                         min_score=0.8):
    ok_edu = set(edu_levels)
    res = []
    for s, u in users.items():
        dev = u.get("пристрої")
        sc = u.get("оцінки")
        if (u.get("освіта") in ok_edu
            and u.get("сімейний_стан") == marital
            and isinstance(dev, int) and dev > min_devices
            and isinstance(sc, (int, float)) and sc > min_score):
            res.append(s)
    return res

print("10:", users_multi_criteria(users))

users["Бондар-239"]

users["Білоус-148"]

users["Мазур-30"]

"""11. Порахувати кількість користувачів у кожному регіоні, які:

мають доходи > 30 000

витрати менші за 4000

і проводять понад 4 години на платформі
"""

def regional_counts_filtered(users, min_income=30000, max_expenses=4000, min_hours=4):
    counts = {}
    for u in users.values():
        inc = u.get("дохід")
        exp = u.get("витрати")
        hrs = u.get("час_на_платформі")
        if (isinstance(inc, (int, float)) and inc > min_income
            and isinstance(exp, (int, float)) and exp < max_expenses
            and isinstance(hrs, (int, float)) and hrs > min_hours):
            reg = u.get("регіон")
            counts[reg] = counts.get(reg, 0) + 1
    return counts

print("11:", regional_counts_filtered(users))

"""12. Побудувати рейтинг користувачів за оцінкою ефективності:
ефективність = оцінки × візити_на_тиждень × час_на_платформі

Вивести топ-5 користувачів з найбільшою ефективністю.
"""

def top_efficiency(users, top_n=5, scale_time=1, round_to=2):
    eff = []
    for s, u in users.items():
        sc = u.get("оцінки")
        vis = u.get("візити_на_тиждень")
        hrs = u.get("час_на_платформі")
        sc  = float(sc) if isinstance(sc,  (int, float)) else 0.0
        vis = float(vis) if isinstance(vis, (int, float)) else 0.0
        hrs = float(hrs) if isinstance(hrs, (int, float)) else 0.0
        value = sc * vis * (hrs * scale_time)
        eff.append((s, round(value, round_to)))
    eff.sort(key=lambda x: x[1], reverse=True)
    return eff[:top_n]

print("12:", top_efficiency(users, top_n=5, scale_time=0.5))

"""13. За допомогою enumerate вивести кожного 10-го користувача (по черзі), що:

має не більше 2 пристроїв

і менше 10 візитів на тиждень
"""

def every_10th_filtered(users, max_devices=2, max_visits=10):
    sel = []
    for idx, (s, u) in enumerate(users.items()):
        if idx % 10 == 0:
            dev = u.get("пристрої")
            vis = u.get("візити_на_тиждень")
            if isinstance(dev, int) and isinstance(vis, int):
                if dev <= max_devices and vis < max_visits:
                    sel.append((idx, s, dev, vis))
    return sel


print("13:", every_10th_filtered(users))

"""14. Вивести кількість користувачів кожної статі у кожному регіоні, що мають:

оцінку ≥ 0.7

вік від 25 до 50
"""

def region_gender_counts(users, min_score=0.7, min_age=25, max_age=50):
    stats = {}
    for u in users.values():
        sc = u.get("оцінки")
        age = u.get("вік")
        if isinstance(sc, (int, float)) and sc >= min_score and isinstance(age, int) and min_age <= age <= max_age:
            key = (u.get("регіон"), u.get("стать"))
            stats[key] = stats.get(key, 0) + 1
    return stats

print("14:", region_gender_counts(users, 0.7, 25, 50))